
---
# Тестовое задание: backend

Фирма создаёт мобильные приложения и иногда для тестирования гипотез приходится запускать AB-тесты. Для этого нужна система, представляющая собой простейшее REST API, состоящее из одного эндпойнта.

## API и распределение

Мобильное приложение при запуске генерирует некоторый уникальный ID клиента (который сохраняется между сессиями) и запрашивает список экспериментов, добавляя HTTP-заголовок `Device-Token`. В ответ сервер отдаёт список экспериментов. Для каждого эксперимента клиент получает:

* Ключ: имя эксперимента. В клиенте есть код, который будет изменять какое-то поведение в зависимости от значения этого ключа
* Значение: строка, одна из возможных опций (см. ниже)

Важно, чтобы девайс попадал в одну группу и всегда оставался в ней.

## Эксперименты
### 1. Цвет кнопки

У нас есть гипотеза, что цвет кнопки «купить» влияет на конверсию в покупку

* Ключ: `button_color`
* Опции:
  * `#FF0000` → 33.3%
  * `#00FF00` → 33.3%
  * `#0000FF` → 33.3%

Так после 600 запросов к API с различными `DeviceToken` каждый цвет должны получить по 200 девайсов

### 2. Стоимость покупки

У нас есть гипотеза, что изменение стоимости покупки в приложении может повлять на нашу маржинальную прибыль. Но чтобы не терять деньги в случае неудачного эксперимента, 75% юзеров будут получать старую цену и только на малой части аудитории мы протестируем изменение:

* Ключ `price`
* Опции:
  * `10` → 75%
  * `20` → 10%
  * `50` → 5%
  * `5` → 10%


## Требования и ограничения

1. Если девайс однажды получил значение, то он всегда будет получать только его
1. Эксперимент проводится только для новых девайсов: если эксперимент создан после первого запроса от девайса, то девайс не должен ничего знать об этом эксперименте

## Задание

1. Спроектируйте, опишите и реализуйте API
2. Добавьте эксперименты (1) и (2) в приложение
3. Создайте страницу для статистики: простая таблица со списком экспериментов, общее количество девайсов, участвующих в эксперименте и их распределение между опциями

Можно использовать любые тенхологии и библиотеки

Плюсом будет:

* Наличие тестов
* Задеплоенная версия приложения
* Скорость ответа от сервера < 100ms
---
# Установка проекта Django и DRF с API и веб-интерфейсом
1.Склонируйте репозиторий:
   ```bash
git clone https://github.com/Krd2024/Experiments_in_sales.git
```
2.Создание виртуального окружения
```bash
python -m venv .venv
```
3.Активация виртуального окружения
```bash
.venv\Scripts\activate
```
4.Установка зависимостей проекта
```bash
pip install -r requirements.txt
```

**Создать файл .env**
Добавьте соответствующие значения в .env файл:
```python
SECRET_KEY="django-insecure-jb2x-b&$gfb$yf-&p5xtrt)pz#hqm)!l3cvimmi046g9dch8z!"
```
5.Миграции
```bash
python manage.py migrate
```
6.Создать таблицу в базе данных для хранения кеша
```bash
python manage.py createcachetable
```
7.Запуск
```bash
python manage.py runserver
```
## После запуска проект доступен:
```bash
http://127.0.0.1:8000/
```

## API документация:
```bash
http://127.0.0.1:8000/api/v1/docs/
```

## Возможности
- Вкладка "Тест" позволяет записать в базу данных большое количество устройств и увидеть распределение цветов и цен как в процентном, так и в количественном соотношении.
- Вкладка «Основная статистика» отображает то же, что и «Тест», но для устройств, полученных по API для взаимодействия с внешними сервисами.

---

![2025-02-15_14-40-25](https://github.com/user-attachments/assets/642d3e00-dc1d-4221-8277-5ea361940619)

---

![2025-02-15_14-39-54](https://github.com/user-attachments/assets/270f9a39-b929-4219-a170-3bd0f7fff0b5)

---
![2025-02-15_14-43-26](https://github.com/user-attachments/assets/2fb2c8a3-c7e3-488b-8073-e8e3f99aea7d)

---
![2025-02-15_14-52-26](https://github.com/user-attachments/assets/c8998025-14d2-47ad-a7b5-a42e5e29ec25)
![2025-02-15_14-52-48](https://github.com/user-attachments/assets/3d8018b1-ec15-42a8-aa79-52a4ec375b7a)





